<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Scientific Calculator Mini App</title>
<style>
body { font-family:'Arial'; display:flex; justify-content:center; align-items:center; height:100vh; background:#e0e0e0; margin:0; }
#calculator { background:#1e1e1e; padding:15px; border-radius:12px; max-width:400px; width:95%; color:white; box-shadow:0 0 20px rgba(0,0,0,0.5);}
#display { width:100%; height:60px; text-align:right; font-size:2rem; margin-bottom:10px; padding:10px; border:none; border-radius:8px; background:#2e2e2e; color:#fff; box-sizing:border-box; }
.row { display:flex; justify-content:center; margin-bottom:5px; }
.btn { flex:1 1 20%; margin:3px; font-size:1.5rem; height:55px; border-radius:8px; cursor:pointer; background:#3a3a3a; color:white; border:none; transition:0.1s; }
.btn:hover { background:#505050; }
.btn-number { background:#4b4b4b; }
.btn-operator { background:#ff9500; color:white; }
.btn-equal { background:#4CAF50; color:white; font-size:1.8rem; flex:1 1 20%; height:55px; }
.btn-clear { background:#f44336; color:white; font-size:1.2rem; flex:1 1 20%; height:50px; }
@media (max-width:360px) { #display{font-size:1.5rem;height:50px;} .btn{font-size:1.2rem;height:45px;} .btn-equal{font-size:1.5rem;height:50px;} .btn-clear{font-size:1rem;height:40px;} }
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.12.0/math.min.js"></script>
</head>
<body>
<div id="calculator">
<input type="text" id="display" value="0" readonly>

<!-- Advanced functions -->
<div class="row">
<button class="btn" onclick="appendFunction('sqrt(')">√</button>
<button class="btn" onclick="appendFunction('^')">^</button>
<button class="btn" onclick="appendFunction('(')">(</button>
<button class="btn" onclick="appendFunction(')')">)</button>
<button class="btn-clear" onclick="clearDisplay()">C</button>
</div>
<div class="row">
<button class="btn" onclick="appendFunction('log(')">log</button>
<button class="btn" onclick="appendFunction('sin(')">sin</button>
<button class="btn" onclick="appendFunction('cos(')">cos</button>
<button class="btn" onclick="appendFunction('tan(')">tan</button>
<button class="btn" onclick="appendFunction('pi')">π</button>
</div>
<div class="row">
<button class="btn btn-number" onclick="appendNumber('7')">7</button>
<button class="btn btn-number" onclick="appendNumber('8')">8</button>
<button class="btn btn-number" onclick="appendNumber('9')">9</button>
<button class="btn btn-operator" onclick="appendOperator('/')">÷</button>
<button class="btn" onclick="appendFunction('e')">e</button>
</div>
<div class="row">
<button class="btn btn-number" onclick="appendNumber('4')">4</button>
<button class="btn btn-number" onclick="appendNumber('5')">5</button>
<button class="btn btn-number" onclick="appendNumber('6')">6</button>
<button class="btn btn-operator" onclick="appendOperator('*')">×</button>
<button class="btn-equal" onclick="calculateResult()">=</button>
</div>
<div class="row">
<button class="btn btn-number" onclick="appendNumber('1')">1</button>
<button class="btn btn-number" onclick="appendNumber('2')">2</button>
<button class="btn btn-number" onclick="appendNumber('3')">3</button>
<button class="btn btn-operator" onclick="appendOperator('-')">-</button>
<button class="btn btn-operator" onclick="appendOperator('+')">+</button>
</div>
<div class="row">
<button class="btn btn-number" style="flex:2" onclick="appendNumber('0')">0</button>
<button class="btn btn-number" onclick="appendNumber('.')">.</button>
</div>
</div>

<script>
let display = document.getElementById('display');
let currentInput = '';
let tg = null;
if(window.Telegram && window.Telegram.WebApp){ tg = window.Telegram.WebApp; tg.expand(); }

function appendNumber(num){ currentInput += num; display.value = currentInput; }
function appendOperator(op){ if(currentInput==='') return; let last=currentInput.slice(-1); if("+-*/".includes(last)){ currentInput=currentInput.slice(0,-1)+op;} else {currentInput+=op;} display.value=currentInput; }
function appendFunction(func){ currentInput += func; display.value=currentInput; }
function clearDisplay(){ currentInput=''; display.value='0'; }
function calculateResult(){
    try{
        if(currentInput==='') return;
        let result = math.evaluate(currentInput).toString();
        display.value=result;
        currentInput=result;
        if(tg) tg.sendData(result);  // send to Telegram bot
    } catch(err){ display.value='Error'; currentInput=''; }
}
</script>
</body>
</html>
